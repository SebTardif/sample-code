#!/bin/bash

echo "Run some correct GET commands"
curl -s -X GET "$CAR_API_SERVER/car"
echo
curl -s -X GET "$CAR_API_SERVER/garage"
echo

echo "Run correct POST command passing in newcar.json"
curl -s -X POST -d @newcar.json "$CAR_API_SERVER/car"
echo

echo
echo "Run GET command with wrong path"
curl -s -o response.html -X GET "$CAR_API_SERVER/attack"
blocked=$(cat response.html | grep -c "Access denied")
[ "$blocked" == "1" ] && echo "Attack blocked, wrong api path" 
echo

echo
echo "Run POST command with wrong path"
curl -s -o response.html -X POST -d @newcar.json "$CAR_API_SERVER/attack"
blocked=$(cat response.html | grep -c "Access denied")
[ "$blocked" == "1" ] && echo "Attack blocked, wrong api path"
echo

